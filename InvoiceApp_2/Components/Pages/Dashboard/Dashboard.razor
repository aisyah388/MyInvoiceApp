@page "/"
@using static InvoiceApp_2.Services.StatusService
@using static InvoiceApp_2.Services.InvoiceService
@inject InvoiceService InvoiceService
@inject StatusService StatusService

<MudText Typo="Typo.h4" Class="mb-4">Dashboard</MudText>

@if (summaryData == null && statusData == null)
{
    <MudProgressCircular Color="Color.Default" Indeterminate="true" />
}
else
{
    <div style="display: flex; flex-wrap: wrap; gap: 1rem;">
        <div style="flex: 1; height: 400px;">
            <MyInvoiceApp.Components.Pages.Chart.Invoice.Monthly SummaryData="summaryData" />
        </div>
        <div style="flex: 1; height: 400px;">
            <MyInvoiceApp.Components.Pages.Chart.Invoice.Status StatusSummaries="statusData" />
        </div>
    </div>
}

@code {
    private List<InvoiceSummary>? summaryData;
    private List<StatusSummary>? statusData;

    protected override async Task OnInitializedAsync()
    {
        summaryData = await InvoiceService.GetInvoiceSummary();
        statusData = await StatusService.GetInvoiceCountByStatus();
    }
}
